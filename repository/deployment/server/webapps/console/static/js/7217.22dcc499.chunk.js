"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[7217],{87217:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ze});var o=t(78367),a=t(51177),r=t(17199),i=t(73125),c=t(55007),l=t(40838),s=t(86105),u=t(78132),m=t(50699),d=t(44194),h=t(10479),f=t(47245),p=t(39114),b=t(89141),g=t(2292),k=t(76271),v=t(43939),w=t(6833),E=t(33241),y=g.AsgardeoSPAClient.getInstance().httpRequest.bind(g.AsgardeoSPAClient.getInstance());const x=function(e,n){var t={headers:{Accept:"application/json","Content-Type":"application/json"},method:w.f2.POST,url:"".concat(k.h.getState().config.endpoints.webhooks,"/").concat(e,"/").concat(n)};return y(t).then((function(e){if(200!==e.status)throw new v.u(E.J.ERROR_MESSAGES.UPDATE_WEBHOOK_STATUS_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve()})).catch((function(e){var n;throw new v.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var S=g.AsgardeoSPAClient.getInstance().httpRequest.bind(g.AsgardeoSPAClient.getInstance());const A=function(e){var n={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:w.f2.POST,url:"".concat(k.h.getState().config.endpoints.webhooks)};return S(n).then((function(e){if(201!==e.status)throw new v.u(E.J.ERROR_MESSAGES.CREATE_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n;throw new v.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var C=t(52087),T=g.AsgardeoSPAClient.getInstance().httpRequest.bind(g.AsgardeoSPAClient.getInstance()),I=g.AsgardeoSPAClient.getInstance().httpRequest.bind(g.AsgardeoSPAClient.getInstance());const O=function(e,n){var t={data:n,method:w.f2.PUT,url:"".concat(k.h.getState().config.endpoints.webhooks,"/").concat(e)};return I(t).then((function(e){if(200!==e.status)throw new v.u(E.J.ERROR_MESSAGES.UPDATE_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n;throw new v.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var Z=t(96124);const N=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t={headers:{Accept:"application/json","Content-Type":"application/json"},method:w.f2.GET,url:"".concat(k.h.getState().config.endpoints.webhooksMetadata,"/event-profiles/").concat(e)},o=(0,Z.Z)(n&&e?t:null,{shouldRetryOnError:!1});return{data:o.data,error:o.error,isLoading:o.isLoading,isValidating:o.isValidating,mutate:o.mutate}};const P=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return N(E.J.DEFAULT_EVENT_PROFILE.name,e)};const R=function(e){var n={headers:{Accept:"application/json","Content-Type":"application/json"},method:w.f2.GET,url:"".concat(k.h.getState().config.endpoints.webhooks,"/").concat(e)},t=!(0,m.Z)(e)&&"new"!==e,o=(0,Z.Z)(t?n:null,{shouldRetryOnError:!1});return{data:o.data,error:o.error,isLoading:o.isLoading,isValidating:o.isValidating,mutate:o.mutate}};var _=t(58951),L=t(84394),F=t(78079),V=t(79438),M=t(51835),W=t.n(M),U=t(27975),j=t.n(U),H=t(55900),D=t.n(H),B=t(21555),q=t.n(B),K=t(3621),Y=t.n(K),J=t(5062),z=t.n(J),G=t(7294),$={};$.styleTagTransform=z(),$.setAttributes=q(),$.insert=D().bind(null,"head"),$.domAPI=j(),$.insertStyleElement=Y();W()(G.Z,$);G.Z&&G.Z.locals&&G.Z.locals;var X=t(31958),Q=t(66466),ee=t(67197),ne=t(41512),te=t(81901),oe=t(26154),ae=t(57982);const re=function(e){var n,t,o=e.channelConfigs,a=e.isReadOnly,r=e.channelSubscriptions,i=void 0===r?[]:r,c=e["data-componentid"],l=void 0===c?"webhook-channel-config-form":c,s=o,u=(0,h.$)().t,m=function(e){var n,t,o=function(e){switch(e){case ae.U.SUBSCRIPTION_ACCEPTED:return{color:"success",icon:"check",iconColor:"green",text:u("webhooks:configForm.channels.status.subscriptionAccepted")};case ae.U.SUBSCRIPTION_ERROR:return{color:"warning",icon:"exclamation triangle",iconColor:"orange",text:u("webhooks:configForm.channels.status.subscriptionError")};case ae.U.UNSUBSCRIPTION_ACCEPTED:return{color:"success",icon:"check",iconColor:"green",text:u("webhooks:configForm.channels.status.unsubscriptionAccepted")};case ae.U.UNSUBSCRIPTION_ERROR:return{color:"warning",icon:"exclamation triangle",iconColor:"orange",text:u("webhooks:configForm.channels.status.unsubscriptionError")};default:return null}}((n=e.channelUri,(null==(t=i.find((function(e){return e.channelUri===n})))?void 0:t.status)||null));return o?d.createElement("span",{className:"channel-status-inline ".concat(o.color)},d.createElement(oe.Z,{className:"status-icon",name:o.icon,color:o.iconColor,size:"small"}),o.text):null},f=function(e){return d.createElement(X.Z,{key:e.key,className:"channel-checkbox-container"},d.createElement(X.Z,{className:"checkbox-control"},d.createElement(V.SE,{ariaLabel:e.name,"data-componentid":"".concat(l,"-").concat(e.key,"-checkbox"),name:"channels.".concat(e.key),component:te.Z,disabled:a,label:d.createElement(X.Z,{className:"checkbox-label"},d.createElement(X.Z,{className:"channel-name-container"},d.createElement(Q.Z,{variant:"body1",component:"span",className:"channel-name"},e.name),m(e)),d.createElement(Q.Z,{variant:"caption",component:"div",className:"channel-description"},e.description))})))};return d.createElement("div",{className:"webhook-channel-config-form"},d.createElement(Q.Z,{variant:"h6",className:"heading-container"},u("webhooks:configForm.channels.heading")),d.createElement(Q.Z,{variant:"body2",color:"text.secondary",className:"section-description"},u("webhooks:configForm.channels.subHeading")),(n=s.slice(0,Math.ceil(s.length/2)),t=s.slice(Math.ceil(s.length/2)),d.createElement(ee.ZP,{container:!0,spacing:3,className:"channel-grid"},d.createElement(ee.ZP,{item:!0,xs:12,md:6},d.createElement(ne.Z,null,n.map((function(e){return f(e)})))),d.createElement(ee.ZP,{item:!0,xs:12,md:6},d.createElement(ne.Z,null,t.map((function(e){return f(e)})))))))};var ie=t(23351),ce=t(22764),le=t(59673),se=t(24629),ue={};ue.styleTagTransform=z(),ue.setAttributes=q(),ue.insert=D().bind(null,"head"),ue.domAPI=j(),ue.insertStyleElement=Y();W()(se.Z,ue);se.Z&&se.Z.locals&&se.Z.locals;function me(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,r,i,c=[],l=!0,s=!1;try{if(r=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(o=r.call(t)).done)&&(c.push(o.value),c.length!==n);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return de(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?de(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}const he=function(e){var n=e.initialValues,t=e.isCreateFormState,r=e.isReadOnly,c=e.isWebSubHubAdopterMode,l=e["data-componentid"],s=void 0===l?"webhook-endpoint-config-form":l,m=me((0,d.useState)(!1),2),f=m[0],p=m[1],b=me((0,d.useState)(!1),2),g=b[0],k=b[1],v=(0,h.$)().t;(0,d.useEffect)((function(){null!=n&&n.id&&!t?k(!1):t&&k(!0)}),[n]);var w,E,y=function(){k(!0)},x=function(){k(!1)};return d.createElement("div",{className:"webhook-endpoint-config-form"},d.createElement("div",{className:"form-field-wrapper"},d.createElement(V.SE,{key:"name",width:16,FormControlProps:{margin:"dense"},ariaLabel:"webhookName",required:!0,"data-componentid":"".concat(s,"-webhook-name"),name:"name",type:"text",label:v("webhooks:configForm.fields.name.label"),placeholder:v("webhooks:configForm.fields.name.placeholder"),helperText:d.createElement(u.kW,{className:"hint",compact:!0},v("webhooks:configForm.fields.name.hint")),component:V.xh,maxLength:100,minLength:0,disabled:r})),d.createElement("div",{className:"form-field-wrapper"},d.createElement(V.SE,{key:"uri",width:16,FormControlProps:{margin:"dense"},ariaLabel:"endpoint",required:!0,"data-componentid":"".concat(s,"-webhook-endpointUri"),name:"endpoint",type:"text",label:v("webhooks:configForm.fields.endpoint.label"),placeholder:v("webhooks:configForm.fields.endpoint.placeholder"),helperText:d.createElement(u.kW,{className:"hint",compact:!0},v("webhooks:configForm.fields.endpoint.hint")),component:V.xh,maxLength:100,minLength:0,disabled:r}),d.createElement(ce.gN,{name:"endpoint",subscription:{value:!0}},(function(e){var n;return(null===(n=e.input.value)||void 0===n?void 0:n.startsWith("http://"))?d.createElement(o.Z,{severity:"warning",className:"endpoint-uri-alert","data-componentid":"".concat(s,"-endpoint-uri-alert")},d.createElement(le.c,{i18nKey:v("webhooks:configForm.fields.endpoint.validations.notHttps")})):null}))),d.createElement("div",{className:"form-field-wrapper"},g?d.createElement("div",{className:"box-field"},d.createElement(d.Fragment,null,d.createElement(V.SE,{key:"secret",className:"text-field-container",width:16,FormControlProps:{margin:"dense"},ariaLabel:"secret",required:t||g,"data-componentid":"".concat(s,"-secret-property-field"),name:"secret",type:f?"text":"password",InputProps:{endAdornment:(w=f,E=function(){return p(!f)},d.createElement(ie.Z,{position:"end"},d.createElement(oe.Z,{link:!0,className:"list-icon reset-field-to-default-adornment",size:"small",color:"grey",name:w?"eye slash":"eye","data-componentid":"".concat(s,"-secret-property-view-button"),onClick:E})))},label:v("webhooks:configForm.fields.secret.label"),placeholder:v("webhooks:configForm.fields.secret.placeholder"),helperText:d.createElement(u.kW,{className:"hint-text",compact:!0},v("webhooks:configForm.fields.secret.hint.common"),v(t?c?"webhooks:configForm.fields.secret.hint.createWebSubHubMode":"webhooks:configForm.fields.secret.hint.create":"webhooks:configForm.fields.secret.hint.update")),component:V.xh,maxLength:100,minLength:0,disabled:r})),!t&&d.createElement(i.Z,{onClick:x,variant:"outlined",size:"small",className:"secondary-button","data-componentid":"".concat(s,"-cancel-edit-secret-button")},v("webhooks:configForm.buttons.cancel"))):d.createElement(o.Z,{className:"alert-nutral",icon:!1},d.createElement(a.Z,{className:"alert-title","data-componentid":"".concat(s,"-secret-info-box-title")},d.createElement(le.c,{i18nKey:v("webhooks:configForm.fields.secret.info.title"),components:{strong:d.createElement("strong",null)}})),d.createElement(le.c,{i18nKey:v(c?"webhooks:configForm.fields.secret.info.messageWebSubHubMode":"webhooks:configForm.fields.secret.info.message")}),!c&&d.createElement("div",null,d.createElement(i.Z,{onClick:y,variant:"outlined",size:"small",className:"secondary-button","data-componentid":"".concat(s,"-change-secret-button"),disabled:r},v("webhooks:configForm.buttons.changeSecret"))))))};var fe=t(34194),pe=function(e,n,t){var o={},a=function(e,n){return null!=e&&e.trim()?E.J.WEBHOOK_NAME_REGEX.test(e)?void 0:n("webhooks:configForm.fields.name.validations.invalid"):n("webhooks:configForm.fields.name.validations.empty")}(null==e?void 0:e.name,t);a&&(o.name=a);var r=function(e,n){return null!=e&&e.trim()?fe.I.url(e,{domain:{allowUnicode:!0,minDomainSegments:1,tlds:!1},scheme:["https","http"]})?void 0:n("webhooks:configForm.fields.endpoint.validations.invalid"):n("webhooks:configForm.fields.endpoint.validations.empty")}(null==e?void 0:e.endpoint,t);r&&(o.endpoint=r);var i=function(e,n,t){return!n||null!=e&&e.trim()?null!=e&&e.trim()&&!E.J.WEBHOOK_SECRET_REGEX.test(e)?t("webhooks:configForm.fields.secret.validations.invalid"):void 0:t("webhooks:configForm.fields.secret.validations.empty")}(null==e?void 0:e.secret,n,t);i&&(o.secret=i);var c=function(e,n){if(!Object.values(e||{}).some(Boolean))return n("webhooks:configForm.channels.validations.empty")}(null==e?void 0:e.channels,t);return c&&(o.channels=c),o},be=t(84931),ge={};ge.styleTagTransform=z(),ge.setAttributes=q(),ge.insert=D().bind(null,"head"),ge.domAPI=j(),ge.insertStyleElement=Y();W()(be.Z,ge);be.Z&&be.Z.locals&&be.Z.locals;const ke=function(e){var n=e.initialValues,t=e.channelConfigs,o=e.channelSubscriptions,a=e.isLoading,c=e.isReadOnly,l=e.isCreateFormState,s=e.onSubmit,m=e.isSubmitting,f=e.hideSubmitButton,p=e.isWebSubHubAdopterMode,b=e["data-componentid"],g=void 0===b?"webhook-config-form":b,k=(0,h.$)().t,v=function(){return a?d.createElement(r.Z,{className:"placeholder-box"},d.createElement(F.Z,{variant:"rectangular",height:7,width:"30%"}),d.createElement(F.Z,{variant:"rectangular",height:28}),d.createElement(F.Z,{variant:"rectangular",height:7,width:"90%"}),d.createElement(F.Z,{variant:"rectangular",height:7})):d.createElement(d.Fragment,null,d.createElement(he,{initialValues:n,isCreateFormState:l,isReadOnly:c,isWebSubHubAdopterMode:p,"data-componentid":"".concat(g,"-endpoint-config-form")}),d.createElement(L.Z,{className:"divider-container"}),d.createElement(re,{channelConfigs:t,channelSubscriptions:o,isReadOnly:c,"data-componentid":"".concat(g,"-channel-config-form")}))};return d.createElement(r.Z,null,d.createElement(V.vy,{onSubmit:function(e){null==s||s(e)},validate:function(e){return pe(e,l,k)},initialValues:n,render:function(e){var n=e.handleSubmit,t=e.submitting,o=e.invalid;return d.createElement(r.Z,{component:"form",onSubmit:n},d.createElement(u.pJ,{className:"form-wrapper",padded:"very","data-componentid":"".concat(g,"-section")},d.createElement(r.Z,{className:"form-container with-max-width"},v(),!a&&!f&&d.createElement(i.Z,{size:"medium",variant:"contained",type:"submit",className:"button-container","data-componentid":"".concat(g,"-primary-button"),loading:m||t,disabled:c||o},k(l?"webhooks:configForm.buttons.create":"webhooks:configForm.buttons.update")))))}}))};var ve=t(18982),we=t(7238),Ee=t(67071),ye=t(72765),xe={};xe.styleTagTransform=z(),xe.setAttributes=q(),xe.insert=D().bind(null,"head"),xe.domAPI=j(),xe.insertStyleElement=Y();W()(ye.Z,xe);ye.Z&&ye.Z.locals&&ye.Z.locals;function Se(e){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Se(e)}function Ae(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Ce(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Ae(Object(t),!0).forEach((function(n){Te(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ae(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Te(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=Se(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=Se(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==Se(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Ie(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,r,i,c=[],l=!0,s=!1;try{if(r=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;l=!1}else for(;!(l=(o=r.call(t)).done)&&(c.push(o.value),c.length!==n);l=!0);}catch(e){s=!0,a=e}finally{try{if(!l&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(s)throw a}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return Oe(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Oe(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}const Ze=function(e){var n,t,g,y=e["data-componentid"],S=void 0===y?"webhook-edit-page":y,I=(0,f.v9)((function(e){var n;return null===(n=e.config.ui.features)||void 0===n?void 0:n.webhooks})),Z=(0,h.$)().t,N=(0,u.fQ)().getLink,L=(0,ve.Z)(),F=L.navigateToWebhookEditById,V=L.navigateToWebhooksList,M=(0,c.EV)(null==I||null===(n=I.scopes)||void 0===n?void 0:n.update),W=(0,c.EV)(null==I||null===(t=I.scopes)||void 0===t?void 0:t.create),U=(0,c.EV)(null==I||null===(g=I.scopes)||void 0===g?void 0:g.delete),j=(0,d.useMemo)((function(){var e=l.m.location.pathname.split("/");return e[e.length-1]}),[l.m.location.pathname]),H=!j||"new"===j||""===j,D=Ie((0,d.useState)(!1),2),B=D[0],q=D[1],K=Ie((0,d.useState)(!1),2),Y=K[0],J=K[1],z=Ie((0,d.useState)(!1),2),G=z[0],$=z[1],X=Ie((0,d.useState)(!1),2),Q=X[0],ee=X[1],ne=Ie((0,d.useState)(!1),2),te=ne[0],oe=ne[1],re=Ie((0,d.useState)(!1),2),ie=re[0],ce=re[1],le=(0,s.cr)(I,E.J.FEATURE_DICTIONARY.get("SESSION_EVENT_HANDLER")),se=(0,s.cr)(I,E.J.FEATURE_DICTIONARY.get("TOKEN_EVENT_HANDLER")),ue=R(j),me=ue.data,de=ue.isLoading,he=ue.error,fe=ue.mutate,pe=P(),be=pe.data,ge=pe.isLoading,ye=pe.error,xe=(0,_.Z)(),Se=xe.data,Ae=xe.isLoading,Oe=xe.error,Ze=(0,Ee.L)(),Ne=(0,Ee.F)(),Pe=de||ge||Ae,Re=(0,d.useMemo)((function(){if(!be)return[];var e=Te(Te({},E.J.WEBHOOKS_SESSION_EVENT_SCHEMA,le),E.J.WEBHOOKS_TOKEN_EVENT_SCHEMA,se);return function(e){return e.channels.map((function(e){return{channelUri:e.uri,description:e.description,key:e.name,name:e.name}}))}(be).map((function(e){var n,t;return{channelUri:e.channelUri,description:null!==(n=e.description)&&void 0!==n?n:"",key:e.key,name:null!==(t=e.name)&&void 0!==t?t:""}})).filter((function(n){return!1!==e[n.channelUri]}))}),[be,le,se]),_e=(0,d.useMemo)((function(){var e={channels:{},endpoint:"",id:"",name:"",secret:""};if(0===Re.length)return e;var n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1};Re.forEach((function(t){e.channels[t.key]=n(t.channelUri)}))};if(me&&!H){var t=Ce(Ce({},e),{},{endpoint:me.endpoint,id:me.id,name:me.name,secret:me.secret||""});return n((function(e){var n;return(null===(n=me.channelsSubscribed)||void 0===n?void 0:n.some((function(n){return n.channelUri===e})))||!1})),Ce(Ce({},t),{},{channels:e.channels})}return n(),e}),[me,H,Re]),Le=(0,d.useCallback)((function(){return!(null==Se||!Se.adapter)&&we.ZT.isWebSubHub(Se.adapter)}),[Se]),Fe=(0,d.useCallback)((function(){return H?!W:!!Le()||!M}),[H,W,M,Le]),Ve=(0,d.useCallback)((function(){return!H&&M}),[H,M]),Me=(0,d.useCallback)((function(){return!(Pe||H||(0,m.Z)(me))&&!!U}),[Pe,H,me,U]),We=(0,d.useCallback)((function(){return!(!Le()||!me)&&(me.status===ae.v.ACTIVE||me.status===ae.v.PARTIALLY_ACTIVE)}),[Le,me]);(0,d.useEffect)((function(){me&&(me.status===ae.v.ACTIVE||me.status===ae.v.PARTIALLY_ACTIVE?q(!0):me.status!==ae.v.INACTIVE&&me.status!==ae.v.PARTIALLY_INACTIVE||q(!1))}),[me]),(0,d.useEffect)((function(){he&&Ne(he,"fetchWebhook")}),[he,Ne]),(0,d.useEffect)((function(){ye&&Ne(ye,"fetchEventProfile")}),[ye,Ne]),(0,d.useEffect)((function(){Oe&&Ne(Oe,"fetchWebhooksMetadata")}),[Oe,Ne]);var Ue=(0,d.useCallback)((function(e){var n=function(e,n){var t=[];return n.forEach((function(n){e.channels[n.key]&&t.push(n.channelUri)})),t}(e,Re);if(H){if(!W)return;var t={channelsSubscribed:n,endpoint:e.endpoint||"",eventProfile:{name:be.profile,uri:be.uri},name:e.name,secret:e.secret,status:B?ae.v.ACTIVE:ae.v.INACTIVE};$(!0),A(t).then((function(e){Ze("createWebhook"),F(e.id)})).catch((function(e){Ne(e,"createWebhook")})).finally((function(){$(!1)}))}else{if(!M)return;var o={channelsSubscribed:n,endpoint:e.endpoint||"",eventProfile:{name:be.profile,uri:be.uri},name:e.name,status:B?ae.v.ACTIVE:ae.v.INACTIVE};e.secret&&""!==e.secret.trim()&&(o.secret=e.secret),$(!0),O(j,o).then((function(){Ze("updateWebhook"),fe()})).catch((function(e){Ne(e,"updateWebhook")})).finally((function(){$(!1)}))}}),[Re,H,W,M,be,B,j,Ze,Ne,fe,F]),je=(0,d.useCallback)((function(e,n){if(M||H){var t=!!n.checked;if(!H&&j&&me){var o=t?"activate":"deactivate";ee(!0),x(j,o).then((function(){q(t),Ze("updateWebhookStatus",{status:t?"active":"inactive"}),fe()})).catch((function(e){q(!t),Ne(e,"updateWebhookStatus")})).finally((function(){ee(!1)}))}else q(t)}}),[M,H,j,me,Ze,Ne,fe]),He=(0,d.useCallback)((function(){if(j&&me&&M){var e=me.status===ae.v.PARTIALLY_ACTIVE?"subscription":"unsubscription";ce(!0),function(e){var n={headers:{Accept:"application/json","Content-Type":"application/json"},method:w.f2.POST,url:"".concat(k.h.getState().config.endpoints.webhooks,"/").concat(e,"/retry")};return T(n).then((function(e){if(200!==e.status)throw new v.u(E.J.ERROR_MESSAGES.RETRY_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){throw new v.u(e.message,e.stack,e.code,e.request,e.response,e.config)}))}(j).then((function(){Ze("retryWebhookState",{requestType:e}),fe()})).catch((function(e){Ne(e,"retryWebhookState")})).finally((function(){ce(!1)}))}}),[j,me,M,Ze,Ne,fe]),De=(0,d.useCallback)((function(){U&&(oe(!0),(0,C.Z)(j).then((function(){Ze("deleteWebhook"),V()})).catch((function(e){Ne(e,"deleteWebhook")})).finally((function(){oe(!1),J(!1)})))}),[U,j,Ze,Ne,V]),Be=(0,d.useCallback)((function(){V()}),[V]),qe=(0,d.useCallback)((function(){if(!me)return null;switch(me.status){case ae.v.PARTIALLY_ACTIVE:return{message:Z("webhooks:statusBanner.pendingActivation.message"),severity:"warning",title:Z("webhooks:statusBanner.pendingActivation.title")};case ae.v.PARTIALLY_INACTIVE:return{message:Z("webhooks:statusBanner.pendingDeactivation.message"),severity:"warning",title:Z("webhooks:statusBanner.pendingDeactivation.title")};default:return null}}),[me,Z]),Ke=(0,d.useCallback)((function(){return me&&(me.status===ae.v.PARTIALLY_ACTIVE||me.status===ae.v.PARTIALLY_INACTIVE)?d.createElement(r.Z,{sx:{display:"flex",gap:1,mt:2}},d.createElement(i.Z,{onClick:He,variant:"outlined",className:"button-container","data-componentid":"".concat(S,"-retry-button"),disabled:!Ve()||ie,loading:ie},Z("webhooks:statusBanner.buttons.retry"))):null}),[me,He,Ve,ie,Z,S]),Ye=(0,d.useCallback)((function(){return d.createElement(p.Z,{label:Z(B?"webhooks:common.status.active":"webhooks:common.status.inactive"),toggle:!0,onChange:je,checked:B,readOnly:!M||Q&&!H,disabled:!M||Q&&!H,"data-componentId":"".concat(S,"-webhook-enable-toggle")})}),[B,je,M,Q,H,Z,S]),Je=(0,d.useCallback)((function(){var e=Ye();if(H||!Le())return e;if(!me)return e;var n=qe(),t=me.status===ae.v.PARTIALLY_ACTIVE||me.status===ae.v.PARTIALLY_INACTIVE;return d.createElement(r.Z,{sx:{mb:3},className:"webhook-status-section"},d.createElement(r.Z,{sx:{mb:t?2:0}},e),!Pe&&n&&t&&d.createElement(o.Z,{severity:n.severity,sx:{mb:2},icon:!1},d.createElement(a.Z,null,n.title),n.message,Ke()))}),[H,Le,me,Pe,qe,Ye,Ke]),ze=(0,d.useCallback)((function(){var e=H?"webhooks:pages.create.heading":Le()?"webhooks:pages.edit.headingWebSubHubMode":"webhooks:pages.edit.heading";return d.createElement(d.Fragment,null,Z(e))}),[H,Le,Z,N]),Ge=(0,d.useCallback)((function(){var e=H?"webhooks:pages.create.subHeading":Le()?"webhooks:pages.edit.subHeadingWebSubHubMode":"webhooks:pages.edit.subHeading";return d.createElement(d.Fragment,null,Z(e),d.createElement(u.eb,{link:N("develop.webhooks.learnMore"),showEmptyLink:!1},Z("common:learnMore")))}),[H,Le,Z,N]),$e=(0,d.useCallback)((function(){return Me()?d.createElement(d.Fragment,null,d.createElement(u.v9,{sectionHeader:Z("webhooks:dangerZone.heading")},d.createElement(u.cN,{"data-componentid":"".concat(S,"-danger-zone"),actionTitle:Z("webhooks:dangerZone.delete.actionTitle"),header:Z("webhooks:dangerZone.delete.heading"),subheader:Z("webhooks:dangerZone.delete.subHeading"),isButtonDisabled:We(),onActionClick:function(){U&&!We()&&J(!0)}})),d.createElement(u.cV,{primaryActionLoading:te,"data-componentid":"".concat(S,"-delete-confirmation-modal"),onClose:function(){return J(!1)},type:"negative",open:Y,assertionHint:Z("webhooks:confirmations.delete.assertionHint"),assertionType:"checkbox",primaryAction:Z("common:confirm"),secondaryAction:Z("common:cancel"),onSecondaryActionClick:function(){return J(!1)},onPrimaryActionClick:De,closeOnDimmerClick:!1},d.createElement(u.cV.Header,{"data-componentid":"".concat(S,"-delete-confirmation-modal-header")},Z("webhooks:confirmations.delete.heading")),d.createElement(u.cV.Message,{"data-componentid":"".concat(S,"-delete-confirmation-modal-message"),attached:!0,negative:!0},Z("webhooks:confirmations.delete.message")),d.createElement(u.cV.Content,{"data-componentid":"".concat(S,"-delete-confirmation-modal-content")},Z("webhooks:confirmations.delete.content")))):null}),[Me,Z,S,U,te,Y,De,We]);return d.createElement(u.Xg,{title:ze(),description:Ge(),backButton:{"data-componentid":"".concat(S,"-webhooks-page-back-button"),onClick:Be,text:Z("webhooks:goBackToWebhooks")},bottomMargin:!1,contentTopMargin:!0,pageHeaderMaxWidth:!1,"data-componentid":"".concat(S,"-webhooks-page-layout")},Je(),d.createElement(b.Z,{className:"grid-form"},d.createElement(b.Z.Row,{columns:1},d.createElement(b.Z.Column,{width:16},d.createElement(ke,{initialValues:_e,channelConfigs:Re,channelSubscriptions:(null==me?void 0:me.channelsSubscribed)||[],isLoading:Pe,isReadOnly:Fe(),isCreateFormState:H,onSubmit:Ue,isSubmitting:G||te,hideSubmitButton:Le()&&!H,isWebSubHubAdopterMode:Le()})))),$e())}},7294:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".webhook-channel-config-form .heading-container{margin-bottom:8px !important}.webhook-channel-config-form .section-description{margin-top:0;margin-bottom:24px}.webhook-channel-config-form .channel-checkbox-container{margin-bottom:24px}.webhook-channel-config-form .channel-checkbox-container .MuiFormControlLabel-root{align-items:flex-start;margin:0;width:100%}.webhook-channel-config-form .channel-checkbox-container .MuiFormControlLabel-labelPlacementEnd .MuiFormControlLabel-label{padding-top:0;margin-top:0;line-height:1;width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-control{padding:0;margin:0;display:flex;align-items:flex-start;width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-control .MuiCheckbox-root{padding:0;margin:0;margin-right:8px;flex-shrink:0}.webhook-channel-config-form .channel-checkbox-container .checkbox-label{width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container{display:flex;align-items:flex-start;gap:8px;margin-bottom:4px;width:100%;min-height:1.2em}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-name{line-height:1.2;margin:0;padding:0;font-size:14px;flex:1;min-width:0;word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline{display:flex;align-items:center;gap:4px;font-style:italic;font-size:.875rem;flex-shrink:0;white-space:nowrap}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline.success{color:var(--oxygen-palette-success-main)}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline.warning{color:var(--oxygen-palette-success-main)}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline .status-icon{padding:1px}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-description{color:rgba(0,0,0,.6);font-size:12.25px;line-height:1.4;margin-top:4px;word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;width:100%}.webhook-channel-config-form .channel-checkbox-container .channel-grid .MuiGrid-container{gap:24px}.webhook-channel-config-form .channel-checkbox-container .channel-grid .MuiGrid-item{min-width:0}",""]);const c=i},84931:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".form-wrapper .form-container{margin-top:0px;margin-bottom:0px}.form-wrapper .box-container{background-color:#f9fafb;border-radius:8px;padding:30px}.form-wrapper .box-container .box-field{margin-top:20px;margin-left:10px;margin-right:10px}.form-wrapper .text-field-container{margin-top:8px;margin-bottom:8px}.form-wrapper .select-field-container{margin-bottom:8px}.form-wrapper .hint-text{margin-top:0px;margin-bottom:8px}.form-wrapper .divider-container{margin-top:20px;margin-bottom:20px}.form-wrapper .heading-container{margin-top:20px;margin-bottom:20px}.form-wrapper .button-container{margin-top:30px}.form-wrapper .alert-title{font-weight:100}.form-wrapper .secondary-button{font-size:.875rem;padding:6px 12px;min-height:32px;margin-top:10px}.form-wrapper .placeholder{border-radius:8px;margin-bottom:8px}.form-wrapper .placeholder.label{height:20px;max-width:100px}.form-wrapper .placeholder.text-field{height:40px}.form-wrapper .placeholder-box>*{margin-bottom:8px}",""]);const c=i},24629:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".webhook-endpoint-config-form .form-field-wrapper{padding:14px 0}.webhook-endpoint-config-form .form-field-wrapper:first-child{padding-top:0}.webhook-endpoint-config-form .form-field-wrapper:last-child{padding-bottom:0}.webhook-endpoint-config-form .alert-nutral,.webhook-endpoint-config-form .MuiAlert-root{margin-top:0;margin-bottom:0}.webhook-endpoint-config-form .endpoint-uri-alert{margin-top:10px;margin-bottom:0}.heading-container{margin-top:20px;margin-bottom:20px;font-weight:normal}.alert-nutral{background-color:var(--oxygen-palette-grey-100)}",""]);const c=i},72765:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".grid-form{margin-top:20px !important;margin-bottom:20px !important}.webhook-status-section{margin:0}.webhook-status-section .secondary-button{height:35px}.webhook-status-section .MuiAlert-root{padding-bottom:14px;margin-bottom:0}",""]);const c=i}}]);